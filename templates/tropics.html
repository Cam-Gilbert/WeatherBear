{% extends "base.html" %}
{% block content %}
<div class="w-full mx-auto mt-2 px-12">

  <!-- Region toggle buttons centered above both panels -->
  <div class="mb-6 flex justify-center">
    <div
      id="region-tabs"
      class="inline-flex rounded-md shadow-sm space-x-4"
      role="tablist"
      aria-label="Select region"
    >
      <!-- Atlantic -->
      <button
        id="btn-atlantic"
        role="tab"
        data-region="atlantic"
        aria-selected="true"
        type="button"
        class="summary-level-btn
               flex-1
               sm:flex-none sm:w-[12rem]
               px-6 py-3           /* base padding */
               sm:px-8 sm:py-4     /* larger on sm+ */
               text-base sm:text-lg
               font-bold
               rounded
               bg-blue-500 text-white hover:bg-blue-600
               focus:outline-none focus:ring-2 focus:ring-blue-400"
        aria-pressed="true"
        >
        Atlantic
      </button>

      <!-- Eastern Pacific -->
      <button
        id="btn-eastern"
        role="tab"
        data-region="eastern_pacific"
        aria-selected="false"
        type="button"
        class="summary-level-btn
                flex-1
                sm:flex-none sm:w-[12rem]
                px-6 py-3 sm:px-8 sm:py-4
                text-base sm:text-lg
                font-bold
                rounded
                bg-gray-800 text-white hover:bg-gray-600
                focus:outline-none focus:ring-2 focus:ring-gray-500"
        aria-pressed="false"
        >
        Eastern Pacific
        </button>

        <!-- Central Pacific -->
      <button
        id="btn-central"
        role="tab"
        data-region="central_pacific"
        aria-selected="false"
        type="button"
        class="summary-level-btn
                flex-1
                sm:flex-none sm:w-[12rem]
                px-6 py-3 sm:px-8 sm:py-4
                text-base sm:text-lg
                font-bold
                rounded
                bg-gray-800 text-white hover:bg-gray-600
                focus:outline-none focus:ring-2 focus:ring-gray-500"
        aria-pressed="false"
        >
        Central Pacific
      </button>
    </div>
  </div>

  <!-- Two-column grid below the buttons -->
  <div class="grid grid-cols-1 xl:grid-cols-24 gap-8">

    <!-- Left Panel: Summary for each region -->
    <div class="md:col-span-9">

      <!-- Atlantic summary -->
      <div id="summary-Atlantic" class="bg-white rounded-xl shadow-lg p-4">
        <h2 class="text-3xl font-bold text-gray-800 mb-3">Atlantic Tropical Weather Summary</h2>

        <!-- Summary level buttons WITHOUT label, centered and spaced -->
        <div class="mb-6 flex justify-center">
          <div class="flex justify-center gap-4 w-full" role="group" aria-label="Summary level" id="expertise-tabs-Atlantic">
            <button type="button" data-region="Atlantic" data-expertise="no_summary" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-blue-500 text-white hover:bg-blue-600" aria-pressed="true">No Summary</button>
            <button type="button" data-region="Atlantic" data-expertise="none" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Novice</button>
            <button type="button" data-region="Atlantic" data-expertise="moderate" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Moderate</button>
            <button type="button" data-region="Atlantic" data-expertise="expert" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Expert</button>
          </div>
        </div>

        <div class="flex items-start gap-3 mb-4">
          <input type="checkbox" id="explain-toggle-Atlantic"
            class="w-5 h-5 rounded accent-blue-600 mt-1">
          <label for="explain-toggle-Atlantic" class="text-sm text-gray-800 leading-snug">
            Enable explanation mode and select a portion of text for an in-depth explanation
          </label>
        </div>  

        <p class="mb-4 text-lg text-gray-600 whitespace-pre-line leading-relaxed">Loading summary for the Atlantic region...</p>
      </div>

      <!-- Central Pacific summary (hidden initially) -->
      <div id="summary-Central_Pacific" class="bg-white rounded-xl shadow-lg p-4 hidden">
        <h2 class="text-3xl font-bold text-gray-800 mb-3">Central Pacific Tropical Weather Summary</h2>

        <div class="mb-6 flex justify-center">
          <div class="flex justify-center gap-4 w-full" role="group" aria-label="Summary level" id="expertise-tabs-Central_Pacific">
            <button type="button" data-region="Central_Pacific" data-expertise="no_summary" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-blue-500 text-white hover:bg-blue-600" aria-pressed="true">No Summary</button>
            <button type="button" data-region="Central_Pacific" data-expertise="none" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Novice</button>
            <button type="button" data-region="Central_Pacific" data-expertise="moderate" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Moderate</button>
            <button type="button" data-region="Central_Pacific" data-expertise="expert" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Expert</button>
          </div>
        </div>

        <div class="flex items-start gap-3 mb-4">
          <input type="checkbox" id="explain-toggle-Central_Pacific"
            class="w-5 h-5 rounded accent-blue-600 mt-1">
          <label for="explain-toggle-Central_Pacific" class="text-sm text-gray-800 leading-snug">
            Enable explanation mode and select a portion of text for an in-depth explanation
          </label>
        </div>

        <p class="mb-4 text-lg text-gray-600 whitespace-pre-line leading-relaxed">Loading summary for the Central Pacific region...</p>
      </div>

      <!-- Eastern Pacific summary (hidden initially) -->
      <div id="summary-Eastern_Pacific" class="bg-white rounded-xl shadow-lg p-4 hidden">
        <h2 class="text-3xl font-bold text-gray-800 mb-3">Eastern Pacific Tropical Weather Summary</h2>

        <div class="mb-6 flex justify-center">
          <div class="flex justify-center gap-4 w-full" role="group" aria-label="Summary level" id="expertise-tabs-Eastern_Pacific">
            <button type="button" data-region="Eastern_Pacific" data-expertise="no_summary" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-blue-500 text-white hover:bg-blue-600" aria-pressed="true">No Summary</button>
            <button type="button" data-region="Eastern_Pacific" data-expertise="none" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Novice</button>
            <button type="button" data-region="Eastern_Pacific" data-expertise="moderate" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Moderate</button>
            <button type="button" data-region="Eastern_Pacific" data-expertise="expert" class="summary-level-btn flex-1 min-w-0 px-4 py-2 text-xs sm:px-6 sm:py-3 sm:text-base rounded bg-gray-800 text-gray-300 hover:bg-gray-600" aria-pressed="false">Expert</button>
          </div>
        </div>

        <div class="flex items-start gap-3 mb-4">
          <input type="checkbox" id="explain-toggle-Eastern_Pacific"
            class="w-5 h-5 rounded accent-blue-600 mt-1">
          <label for="explain-toggle-Eastern_Pacific" class="text-sm text-gray-800 leading-snug">
            Enable explanation mode and select a portion of text for an in-depth explanation
          </label>
        </div>

        <p class="mb-4 text-lg text-gray-600 whitespace-pre-line leading-relaxed">Loading summary for the Eastern Pacific region...</p>
      </div>

    </div>

    <!-- Right Panel: Storm icons for each region -->
    <div class="md:col-span-15">

      <!-- Atlantic storms -->
      <div id="storms-Atlantic" class="bg-white rounded-xl shadow-lg p-4">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Active Atlantic Storms</h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
          <!-- example storm -->
          <div class="storm-icon-card flex flex-col items-center cursor-pointer hover:shadow-lg transition-shadow rounded p-4 bg-sky-100">
            <img src="{{ url_for('static', filename='assets/storm_icon_placeholder.svg') }}" alt="Storm Icon" class="w-16 h-16 mb-2">
            <p class="text-center font-semibold text-gray-700">Storm Alpha</p>
          </div>
          <!-- more storms... -->
        </div>
      </div>

      <!-- Central Pacific storms (hidden) -->
      <div id="storms-Central_Pacific" class="bg-white rounded-xl shadow-lg p-4 hidden">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Active Central Pacific Storms</h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
          <!-- example storm -->
          <div class="storm-icon-card flex flex-col items-center cursor-pointer hover:shadow-lg transition-shadow rounded p-4 bg-sky-100">
            <img src="{{ url_for('static', filename='assets/storm_icon_placeholder.svg') }}" alt="Storm Icon" class="w-16 h-16 mb-2">
            <p class="text-center font-semibold text-gray-700">Storm Gamma</p>
          </div>
        </div>
      </div>

      <!-- Eastern Pacific storms (hidden) -->
      <div id="storms-Eastern_Pacific" class="bg-white rounded-xl shadow-lg p-4 hidden">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Active Eastern Pacific Storms</h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
          <!-- example storm -->
          <div class="storm-icon-card flex flex-col items-center cursor-pointer hover:shadow-lg transition-shadow rounded p-4 bg-sky-100">
            <img src="{{ url_for('static', filename='assets/storm_icon_placeholder.svg') }}" alt="Storm Icon" class="w-16 h-16 mb-2">
            <p class="text-center font-semibold text-gray-700">Storm Delta</p>
          </div>
        </div>
      </div>

    </div>

  </div>

</div>

<script>
  // Region toggle buttons
  const regionButtons = document.querySelectorAll('#region-tabs button');

  // New: use data-region values directly as keys
  const summaries = {
    atlantic: document.getElementById('summary-Atlantic'),
    central_pacific: document.getElementById('summary-Central_Pacific'),
    eastern_pacific: document.getElementById('summary-Eastern_Pacific'),
  };

  const storms = {
    atlantic: document.getElementById('storms-Atlantic'),
    central_pacific: document.getElementById('storms-Central_Pacific'),
    eastern_pacific: document.getElementById('storms-Eastern_Pacific'),
  };

  regionButtons.forEach(button => {
    button.addEventListener('click', () => {
      // Reset styling
      regionButtons.forEach(btn => {
        btn.classList.remove('bg-blue-500', 'text-white', 'hover:bg-blue-600');
        btn.classList.add('bg-gray-800', 'text-gray-300', 'hover:bg-gray-600');
        btn.setAttribute('aria-pressed', 'false');
      });

      // Highlight active button
      button.classList.add('bg-blue-500', 'text-white', 'hover:bg-blue-600');
      button.classList.remove('bg-gray-800', 'text-gray-300', 'hover:bg-gray-600');
      button.setAttribute('aria-pressed', 'true');

      const region = button.dataset.region;

      // Match region key directly
      Object.entries(summaries).forEach(([key, el]) => {
        el.classList.toggle('hidden', key !== region);
      });

      Object.entries(storms).forEach(([key, el]) => {
        el.classList.toggle('hidden', key !== region);
      });
    });
  });


  // Summary level buttons toggle logic (independent groups)
  const expertiseTabs = document.querySelectorAll('[id^="expertise-tabs"]');

  expertiseTabs.forEach(tabGroup => {
    const buttons = tabGroup.querySelectorAll('button');
    buttons.forEach(button => {
      button.addEventListener('click', () => {
        // Reset all buttons in this group
        buttons.forEach(btn => {
          btn.classList.remove('bg-blue-500', 'text-white', 'hover:bg-blue-600');
          btn.classList.add('bg-gray-800', 'text-gray-300', 'hover:bg-gray-600');
          btn.setAttribute('aria-pressed', 'false');
        });

        // Set clicked button active
        button.classList.add('bg-blue-500', 'text-white', 'hover:bg-blue-600');
        button.classList.remove('bg-gray-800', 'text-gray-300', 'hover:bg-gray-600');
        button.setAttribute('aria-pressed', 'true');

        const region = button.dataset.region;
        const expertise = button.dataset.expertise;
        fetchTropicalSummary(region, expertise);
      });
    });
  });

  window.addEventListener("DOMContentLoaded", () => {
    fetchTropicalSummary("Atlantic", "no_summary");
    fetchTropicalSummary("Central_Pacific", "no_summary");
    fetchTropicalSummary("Eastern_Pacific", "no_summary");
  });
</script>

<script type = "module" src = "{{ url_for('static', filename='js/getTropicalSummary.js') }}"></script>
<script type = "module" src = "{{ url_for('static', filename='js/explainer.js') }}"></script>


{% endblock %}
